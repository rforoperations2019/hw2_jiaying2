---
title: "HW2"
author: "Jiaying Shi"
date: "10/3/2019"
output: html_document
---
Each Map will include:

##A Basemap
##One map with a layer of points(Students may use either circles or markers)
##One map with a layer of lines
One map with a layer of polygons
##One of the maps must contain a variable which changes of the color of the elements or the marker with an accompanying legend
##One map must contain a functioning layersControl() with two basemaps and two different layers (by name do not need to be a different type of layer)
```{r setup, include=FALSE}
require(rgdal)
require(leaflet)
require(leaflet.extras)
require(dplyr)
require(readxl)
require(stringr)
```

# Seattle Budiling Map with Permit Type

```{r}
#Load Data
permit <- read.csv("Building_Permit.csv")

pal <- colorFactor(c("#E69F00", "#1A9850"), c("Non-Residential", "Residential"))

#Map
leaflet() %>%
  addProviderTiles("OpenStreetMap.DE") %>%
  #add a layer of points
  addCircleMarkers(data = permit, 
                   lng = ~Longitude, 
                   lat = ~Latitude, 
                   radius = 1,
                   color = ~pal(PermitClassMapped),
                  clusterOptions = markerClusterOptions()) %>%
  #add legend
  addLegend(position = "topright", 
            pal = pal, 
            values = permit$PermitClassMapped, 
            title = "Permit Type")
```

# Seattle Budiling Map with Permit Class

```{r}
type <- unique(permit$PermitClass)

pal1 <-colorFactor(palette = "RdYlBu", domain = type )

#Map
leaflet() %>%
  addProviderTiles("OpenStreetMap.HOT", group = "HOT") %>%
  addProviderTiles("OpenTopoMap", group = "Topo") %>%
  addProviderTiles("Stamen.TonerLite", group = "Toner Lite") %>%
  #add a layer of points
  addCircleMarkers(data = permit, 
                   lng = ~Longitude, 
                   lat = ~Latitude, 
                   radius = 1,
                   color = ~pal1(type)) %>%
  #add legend
  addLegend(position = "bottomright", 
            pal = pal1, 
            values = permit$PermitClass, 
            title = "Permit Class") %>%
  #ass layers control
  addLayersControl(
    baseGroups = c("HOT", "Topo", "Toner Lite"),
    options = layersControlOptions(collapsed = FALSE)
  )

```

# Greater Downtown Alleys in Seattle

```{r}
#Load Data
alley <- readOGR("Greater_Downtown_Alleys.geojson")

#Map
leaflet(data = alley) %>%
  addProviderTiles("OpenStreetMap.DE") %>%
  #add a layer of lines
  addPolylines(color = "blue")

```

Polygon map
```{r}
#Load Data
county <-readOGR("Counties Boundary Map.geojson")


pal2 <- colorNumeric("RdYlBu", county$total_population_2010)

#Map
leaflet(data = county) %>%
  addProviderTiles("OpenStreetMap.DE") %>%
  addPolygons(stroke = FALSE, 
              smoothFactor = 0.2, 
              fillOpacity = 1,
              color = ~as.numeric(total_population_2010)
    )%>%
  addLegend("bottomright",
            pal = pal2, 
            values = ~total_population_2010, 
            Title = "Total Population (2010)",
            opacity = 1)

```

